<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Certificate of Completion - III</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 10pt;
            margin: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 15px;
        }
        .header h1, .header h2 {
            margin: 5px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 9pt;
        }
        th, td {
            border: 1px solid #000;
            padding: 3px 5px;
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            text-align: center;
        }
        .text-right {
            text-align: right;
        }
        .text-center {
            text-align: center;
        }
        .text-bold {
            font-weight: bold;
        }
        .signature {
            margin-top: 20px;
        }
        .signature-line {
            border-top: 1px solid #000;
            width: 200px;
            margin-top: 30px;
        }
        .stamp {
            border: 2px solid #000;
            padding: 10px;
            display: inline-block;
            margin: 20px 0;
            font-size: 12pt;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h2>GOVERNMENT OF RAJASTHAN</h2>
        <h2>PUBLIC WORKS DEPARTMENT</h2>
        <h2>CERTIFICATE OF COMPLETION - III</h2>
    </div>

    <table>
        <tr>
            <td width="25%">Name of Work</td>
            <td width="75%">{{ data.name_of_work or '_________________' }}</td>
        </tr>
        <tr>
            <td>Name of Contractor</td>
            <td>{{ data.contractor_name or '_________________' }}</td>
        </tr>
        <tr>
            <td>Agreement No. & Date</td>
            <td>{{ data.agreement_no }} Dated: {{ data.agreement_date or '_________________' }}</td>
        </tr>
        <tr>
            <td>Period of Contract</td>
            <td>From {{ data.date_commencement or '_________________' }} to {{ data.date_completion or '_________________' }}</td>
        </tr>
        <tr>
            <td>Date of Completion</td>
            <td>{{ data.actual_completion or '_________________' }}</td>
        </tr>
    </table>

    <p>This is to certify that the work mentioned above has been completed in all respects as per the terms and conditions of the contract and the following payments have been made to the contractor:</p>

    <table>
        <thead>
            <tr>
                <th width="10%">Bill No.</th>
                <th width="20%">Date</th>
                <th width="40%">Description</th>
                <th width="15%">Amount (Rs.)</th>
                <th width="15%">Remarks</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in data.payments %}
            <tr>
                <td class="text-center">{{ payment.bill_no or '' }}</td>
                <td class="text-center">{{ payment.date or '' }}</td>
                <td>{{ payment.description or '' }}</td>
                <td class="text-right">{{ "{:,.2f}".format(payment.amount|float) if payment.amount else '0.00' }}</td>
                <td>{{ payment.remarks or '' }}</td>
            </tr>
            {% endfor %}
            <tr class="text-bold">
                <td colspan="3" class="text-right">Total Payment (Rs.)</td>
                <td class="text-right">{{ "{:,.2f}".format(data.totals.total_payments|float) if data.totals.total_payments else '0.00' }}</td>
                <td></td>
            </tr>
        </tbody>
    </table>

    <div style="margin: 20px 0;">
        <div class="stamp">
            <div>WORK COMPLETED</div>
            <div>AND TAKEN OVER</div>
        </div>
    </div>

    <div class="signature">
        <div style="margin-top: 30px;">
            <div style="float: left; width: 33%;">
                <div class="signature-line"></div>
                <div>Junior Engineer</div>
                <div>Name: {{ data.je_name or '_________________' }}</div>
                <div>Date: ___________________</div>
            </div>
            
            <div style="float: left; width: 33%; text-align: center;">
                <div class="signature-line" style="margin: 0 auto;"></div>
                <div>Assistant Engineer</div>
                <div>Name: {{ data.ae_name or '_________________' }}</div>
                <div>Date: ___________________</div>
            </div>
            
            <div style="float: right; width: 33%; text-align: right;">
                <div class="signature-line" style="margin-left: auto;"></div>
                <div>Executive Engineer</div>
                <div>PWD (Electrical Division)</div>
                <div>Name: {{ data.ee_name or '_________________' }}</div>
                <div>Date: ___________________</div>
            </div>
            
            <div style="clear: both;"></div>
        </div>
    </div>
    
    <div style="margin-top: 20px; font-size: 8pt; text-align: justify;">
        <p><strong>Note:</strong> This certificate is issued subject to the condition that the contractor shall remain responsible for any defect, shrinkage or other faults which may appear within the defect liability period of {{ data.defect_liability_period or '12' }} months from the date of completion.</p>
    </div>
</body>
</html>